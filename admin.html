<!DOCTYPE html>
<html>
<head>
  <title>Panel de Empleados</title>
  <script type="module" src="./scripts/firebase.js"></script>
  <script type="module">
    import {
      auth,
      signInWithEmailAndPassword,
      onAuthStateChanged,
      db,
      ref,
      onChildAdded
    } from "./scripts/firebase.js";

    const loginForm = document.getElementById("login-form");
    const chatPanel = document.getElementById("chat-panel");
    const chatList = document.getElementById("chat-list");

    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const email = loginForm.email.value;
      const password = loginForm.password.value;
      signInWithEmailAndPassword(auth, email, password)
        .then(() => {
          loginForm.style.display = "none";
          chatPanel.style.display = "block";
        })
        .catch((err) => alert("Error: " + err.message));
    });

    onAuthStateChanged(auth, (user) => {
      if (user) {
        const chatRef = ref(db, "messages");
        onChildAdded(chatRef, (snapshot) => {
          const msg = snapshot.val();
          const item = document.createElement("li");
          item.textContent = msg.text;
          chatList.appendChild(item);
        });
      }
    });
  </script>
</head>
<body>
  <h2>Panel de Empleados</h2>
  <form id="login-form">
    <input type="email" name="email" placeholder="Email" required />
    <input type="password" name="password" placeholder="ContraseÃ±a" required />
    <button type="submit">Ingresar</button>
  </form>
  <div id="chat-panel" style="display:none;">
    <ul id="chat-list"></ul>
  </div>
</body>
</html>